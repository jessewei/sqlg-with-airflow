REM !/bin/bash
REM  --------------------------------------------------------------------
REM  load script, generated by Macro                                  
REM  Date Time       : {{FMT_PROG_NOW}}
REM  Target Table    : {SRC_NAME}
REM  Script File     : {PGM_FILE_NAME}.sh
REM  Programmer      : {PGM_FILE_NAME}
REM  Function        : Load flat file into {SRC_NAME}
REM  Remarks         :                                                
REM  ------------------     Revision History      -------------------------
REM  --   Seq. No.    DATE         By         REASON 
REM  ----- -------- ----------- ----------- -------------------------------
REM  ---                                                                   
REM  ----------------------------------------------------------------------

cp DATA/{SRC_SYSNAME}/{SRC_NAME}.D DATA/{SRC_SYSNAME}/{SRC_NAME}.D.utf8

"C:\app\martinchen\product\11.2.0\client_2\BIN"\sqlldr userid={{STAGE.USERID}}/{{STAGE.PASSWORD}}@{{DW_HOST}} control=C:\temp\vbTest\STAGE\ORA\ETLFCT_A\STG_D_ETLFCT_A.ctl bad={{DIR_ETLBASE}}MSG\ORA\ETLFCT_A_{{END.DT.CHAR}}.bad log={{DIR_ETLBASE}}MSG\ORA\ETLFCT_A_{{END.DT.CHAR}}.log

bcp userid=$1/$2@$3 control=SRC/{SRC_SYSNAME}/{SRC_NAME}/{SRC_NAME}.ctl bad=MSG/{SRC_NAME}_$4.bad log=MSG/{SRC_NAME}_$4.log data=DATA/{SRC_SYSNAME}/{SRC_NAME}.D.utf8  

bcp dbo.{SRC_NAME} in {SRC_NAME}.csv -d chief -U sa -P MyPassw0rd -q -c -t  ,

{{DIR_DBTOOL}}\nzload -db {{STAGE}} -t {TBL_NAME} -df {{DIR_TEMP}}{DAT_FILE_NAME}.D.utf8 -lf {{DIR_MSG}}{SRC_FILE_NAME}.msg  -bf {{DIR_MSG}}{SRC_FILE_NAME}.nzbad -host {{DW_HOST}} -ctrlChars {STG_MAX_ERR}{STG_LOAD_OPTION} -u {{STAGE.USERID}} -pw {{STAGE.PASSWORD}} -Dmall -Df *